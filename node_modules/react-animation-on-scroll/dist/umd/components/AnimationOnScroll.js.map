{"version":3,"sources":["../../../src/components/AnimationOnScroll.tsx"],"names":["animatedClass","serverSide","scrollableParentRefInitialValue","offset","duration","style","className","initiallyVisible","animateIn","afterAnimatedIn","animateOut","delay","animatePreScroll","afterAnimatedOut","scrollableParentSelector","animateOnce","children","AnimationOnScroll","useState","animationDuration","opacity","node","useRef","animating","visibilityRef","onScreen","inViewport","delayedAnimationTORef","callbackTORef","scrollableParentRef","getElementTop","useCallback","elm","yPos","getScrollPos","getScrollableParentHeight","getViewportTop","getViewportBottom","isInViewport","y","isAboveViewport","isBelowViewport","isAboveScreen","isBelowScreen","getVisibility","elementTop","elementBottom","visibilityHasChanged","previousVis","currentVis","animate","setTimeout","setClasses","animation","setStyle","animateInTrigger","callback","vis","animateOutTrigger","handleScroll","current","visibility","clearTimeout","listener","useMemo","throttle","useEffect","parentSelector","document","console","window","classNameProps","classes","Object"],"mappings":"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","sourcesContent":["import React, {\n  useMemo,\n  useCallback,\n  useState,\n  useEffect,\n  useRef,\n} from 'react';\nimport throttle from 'lodash.throttle';\n\nconst animatedClass = 'animate__animated';\nconst serverSide = typeof window === 'undefined';\n\nlet scrollableParentRefInitialValue: any = undefined;\nif (!serverSide) {\n  scrollableParentRefInitialValue = window;\n}\n\ntype Props = {\n  offset?: number;\n  duration?: number;\n  style?: any;\n  className?: string;\n  initiallyVisible?: boolean;\n  animateIn?: string;\n  afterAnimatedIn?: any;\n  animateOut?: string;\n  delay?: number;\n  animatePreScroll?: boolean;\n  afterAnimatedOut?: any;\n  scrollableParentSelector?: string;\n  animateOnce?: boolean;\n  children?: any;\n};\n\ntype styleProp = {\n  animationDuration: string;\n  opacity?: number;\n};\n\nexport const AnimationOnScroll = ({\n  offset = 150,\n  duration = 1,\n  style: styleProps,\n  className: classNameProps,\n  initiallyVisible = false,\n  animateIn,\n  afterAnimatedIn,\n  animateOut,\n  delay = 0,\n  animatePreScroll = true,\n  afterAnimatedOut,\n  scrollableParentSelector,\n  animateOnce = false,\n  children,\n}: Props) => {\n  const [classes, setClasses] = useState(animatedClass);\n  const [style, setStyle] = useState<styleProp>({\n    animationDuration: `${duration}s`,\n    opacity: initiallyVisible ? 1 : 0,\n  });\n\n  const node: { current: any } = useRef(null);\n  const animating: { current: boolean } = useRef(false);\n  const visibilityRef: {\n    current: { onScreen: boolean; inViewport: boolean };\n  } = useRef({ onScreen: false, inViewport: false });\n\n  const delayedAnimationTORef: { current: any } = useRef(undefined);\n  const callbackTORef: { current: any } = useRef(undefined);\n  const scrollableParentRef: { current: any } = useRef(scrollableParentRefInitialValue);\n\n  const getElementTop = useCallback((elm: any) => {\n    let yPos = 0;\n    while (elm && elm.offsetTop !== undefined && elm.clientTop !== undefined) {\n      yPos += elm.offsetTop + elm.clientTop;\n      elm = elm.offsetParent;\n    }\n    return yPos;\n  }, []);\n\n  const getScrollPos = useCallback(() => {\n    if (scrollableParentRef.current.pageYOffset !== undefined) {\n      return scrollableParentRef.current.pageYOffset;\n    }\n    return scrollableParentRef.current.scrollTop;\n  }, [scrollableParentRef]);\n\n  const getScrollableParentHeight = useCallback(() => {\n    if (scrollableParentRef.current.innerHeight !== undefined) {\n      return scrollableParentRef.current.innerHeight;\n    }\n    return scrollableParentRef.current.clientHeight;\n  }, [scrollableParentRef]);\n\n  const getViewportTop = useCallback(() => {\n    return getScrollPos() + offset;\n  }, [offset, getScrollPos]);\n\n  const getViewportBottom = useCallback(() => {\n    return getScrollPos() + getScrollableParentHeight() - offset;\n  }, [offset, getScrollPos, getScrollableParentHeight]);\n\n  const isInViewport = useCallback(\n    (y) => {\n      return y >= getViewportTop() && y <= getViewportBottom();\n    },\n    [getViewportTop, getViewportBottom]\n  );\n\n  const isAboveViewport = useCallback(\n    (y) => {\n      return y < getViewportTop();\n    },\n    [getViewportTop]\n  );\n\n  const isBelowViewport = useCallback(\n    (y) => {\n      return y > getViewportBottom();\n    },\n    [getViewportBottom]\n  );\n\n  const inViewport = useCallback(\n    (elementTop, elementBottom) => {\n      return (\n        isInViewport(elementTop) ||\n        isInViewport(elementBottom) ||\n        (isAboveViewport(elementTop) && isBelowViewport(elementBottom))\n      );\n    },\n    [isInViewport, isAboveViewport, isBelowViewport]\n  );\n\n  const isAboveScreen = useCallback(\n    (y) => {\n      return y < getScrollPos();\n    },\n    [getScrollPos]\n  );\n\n  const isBelowScreen = useCallback(\n    (y) => {\n      return y > getScrollPos() + getScrollableParentHeight();\n    },\n    [getScrollPos, getScrollableParentHeight]\n  );\n\n  const onScreen = useCallback(\n    (elementTop, elementBottom) => {\n      return !isAboveScreen(elementBottom) && !isBelowScreen(elementTop);\n    },\n    [isAboveScreen, isBelowScreen]\n  );\n\n  const getVisibility = useCallback(() => {\n    const elementTop =\n      getElementTop(node.current) - getElementTop(scrollableParentRef.current);\n    const elementBottom = elementTop + node.current.clientHeight;\n\n    return {\n      inViewport: inViewport(elementTop, elementBottom),\n      onScreen: onScreen(elementTop, elementBottom),\n    };\n  }, [getElementTop, node, inViewport, onScreen, scrollableParentRef]);\n\n  const visibilityHasChanged = useCallback((previousVis, currentVis) => {\n    return (\n      previousVis.inViewport !== currentVis.inViewport ||\n      previousVis.onScreen !== currentVis.onScreen\n    );\n  }, []);\n\n  const animate = useCallback(\n    (animation, callback) => {\n      delayedAnimationTORef.current = setTimeout(() => {\n        animating.current = true;\n        setClasses(`${animatedClass} ${animation}`);\n        setStyle({ animationDuration: `${duration}s` });\n        callbackTORef.current = setTimeout(callback, duration * 1000);\n      }, delay);\n    },\n    [animating, delay, duration]\n  );\n\n  const animateInTrigger = useCallback(\n    (callback) => {\n      animate(animateIn, () => {\n        if (!animateOnce) {\n          setStyle({\n            animationDuration: `${duration}s`,\n            opacity: 1,\n          });\n          animating.current = false;\n        }\n        const vis = getVisibility();\n        if (callback) {\n          callback(vis);\n        }\n      });\n    },\n    [animating, animateIn, animateOnce, duration, animate, getVisibility]\n  );\n\n  const animateOutTrigger = useCallback(\n    (callback) => {\n      animate(animateOut, () => {\n        setClasses(animatedClass);\n        setStyle({ animationDuration: `${duration}s`, opacity: 0 });\n        const vis = getVisibility();\n\n        if (vis.inViewport && animateIn) {\n          animateInTrigger(afterAnimatedIn);\n        } else {\n          animating.current = false;\n        }\n\n        if (callback) {\n          callback(vis);\n        }\n      });\n    },\n    [\n      animating,\n      animate,\n      animateIn,\n      duration,\n      afterAnimatedIn,\n      animateInTrigger,\n      animateOut,\n      getVisibility,\n    ]\n  );\n\n  const handleScroll = useCallback(() => {\n    if (!animating.current) {\n      const { current: visibility } = visibilityRef;\n      const currentVis = getVisibility();\n      if (visibilityHasChanged(visibility, currentVis)) {\n        clearTimeout(delayedAnimationTORef.current);\n        if (!currentVis.onScreen) {\n          setClasses(animatedClass);\n          setStyle({\n            animationDuration: `${duration}s`,\n            opacity: initiallyVisible ? 1 : 0,\n          });\n        } else if (currentVis.inViewport && animateIn) {\n          animateInTrigger(afterAnimatedIn);\n        } else if (\n          currentVis.onScreen &&\n          visibility.inViewport &&\n          animateOut &&\n          node.current.style.opacity === '1'\n        ) {\n          animateOutTrigger(afterAnimatedOut);\n        }\n        visibilityRef.current = currentVis;\n      }\n    }\n  }, [\n    afterAnimatedIn,\n    afterAnimatedOut,\n    animateIn,\n    animateInTrigger,\n    animateOut,\n    duration,\n    initiallyVisible,\n    visibilityHasChanged,\n    animateOutTrigger,\n    getVisibility,\n  ]);\n\n  const listener = useMemo(\n    () =>\n      throttle(() => {\n        handleScroll();\n      }, 50),\n    [handleScroll]\n  );\n\n  useEffect(() => {\n    if (!serverSide) {\n      const parentSelector = scrollableParentSelector;\n      scrollableParentRef.current = parentSelector\n        ? document.querySelector(parentSelector)\n        : window;\n      if (\n        scrollableParentRef.current &&\n        scrollableParentRef.current.addEventListener\n      ) {\n        scrollableParentRef.current.addEventListener('scroll', listener);\n      } else {\n        console.warn(\n          `Cannot find element by locator: ${scrollableParentSelector}`\n        );\n      }\n      if (animatePreScroll) {\n        handleScroll();\n      }\n\n      return () => {\n        clearTimeout(delayedAnimationTORef.current);\n        clearTimeout(callbackTORef.current);\n        if (window && window.removeEventListener) {\n          window.removeEventListener('scroll', listener);\n        }\n      };\n    }\n  }, [\n    handleScroll,\n    scrollableParentSelector,\n    scrollableParentRef,\n    listener,\n    animatePreScroll,\n  ]);\n\n  return (\n    <div\n      ref={node}\n      className={classNameProps ? `${classNameProps} ${classes}` : classes}\n      style={Object.assign({}, style, styleProps)}\n    >\n      {children}\n    </div>\n  );\n};\n"],"file":"AnimationOnScroll.js"}